<div class="container">


  <div class="row">
    <div class="col s12">
      <div class="card hoverable z-depth-1">
        <div class="card-label">キャラクター</div>
        <div class="card-content">
          <div class="valign-wrapper">
            <%= image_tag @character.image_url, class: "character-image-lg" %>
            <div>
              <div class="valign-wrapper character-prof"><i class="material-icons">person</i><%= @character.name %></div>
              <div class="valign-wrapper character-prof"><i class="material-icons">place</i><%= @character.world %></div>
              <div class="valign-wrapper character-prof"><i class="material-icons">star</i>RANK: #<%= @rank %></div>
              <div class="valign-wrapper character-prof">
                <i class="material-icons">import_contacts</i><%= link_to "Lodestone", "https://jp.finalfantasyxiv.com/lodestone/character/" + @character.id.to_s + "/", target: :_blank %>
              </div>
            </div>
          </div>
        </div>
        <div class="card-action valign-wrapper">
          <i class="material-icons">sync</i><%= link_to "同期", {controller: 'characters', action: 'sync'}, method: :post %>
        </div>

        <div class="card-action valign-wrapper">

          <% if user_signed_in? %>

            <i class="material-icons">account_circle</i>
            <% if @character == current_character %>
              <%= link_to "マイキャラクターを解除", {controller: 'characters', action: 'reset_current_character'}, method: :post %>
            <% else %>
              <%= link_to "マイキャラクターに設定", {controller: 'characters', action: 'set_current_character'}, method: :post %>
            <% end %>
            <a class="tooltipped valign-wrapper help-tooltip" data-position="top" data-tooltip="マイキャラクターに設定するとヘッダーやサイドバーに固定表示できます。">
              <i class="material-icons" style="color:#846C63;">help_outline</i>
            </a>

          <% else %>

            <i class="material-icons">account_circle</i>マイキャラクターに設定
            <a class="tooltipped valign-wrapper help-tooltip" data-position="top" data-tooltip="マイキャラクターに設定するとヘッダーやサイドバーに固定表示できます。<br>マイキャラクターに設定するにはログインが必要です。">
              <i class="material-icons" style="color:#846C63; margin-left: 24px;">help_outline</i>
            </a>

          <% end %>

        </div>

      </div>
    </div>
  </div>


  <div class="row">
    <div class="col s12">
      <div class="card hoverable z-depth-1">
        <div class="card-label">ミニオン取得率</div>
        <div class="card-content">
          <a href="https://twitter.com/share?ref_src=twsrc%5Etfw"
             class="twitter-share-button"
             data-size="large"
             data-text="<%= @character.name %> / <%= @character.world %>, ミニオン取得率: <%= @character.character_minions.count %>/<%= @minions.count %>(<%= (@character.character_minions.count / @minions.count.to_f * 100).round(1) %>%)"
             data-hashtags="FF14MINIONS, FF14"
             data-related="ff14minions"
             data-lang="ja"
             data-show-count="false">ツイート</a>
          <div class="valign-wrapper">
            <span class="rate-title-lg" style="margin-left: auto;">
              <%= @character.character_minions.count %>
            </span>
            <span class="rate-title-sm">
              /<%= @minions.count %>(<%= (@character.character_minions.count / @minions.count.to_f * 100).round(1) %>%)
            </span>
            <div style="margin-right: auto;">
              <%= pie_chart @possession_rate, suffix: "個", width: "300px" %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col s12">
      <div class="card hoverable z-depth-1">
        <div class="card-label">ミニオン</div>
        <div class="card-content">
          <div>

            <% @minions.each do |minion| %>
              <% if minion.owned_by?(@character) %>
                <%= image_tag "#{minion.image_url}", class: "minion-image-sm"%>
              <% else %>
                <%= image_tag "#{minion.image_url}", class: "minion-image-sm", style: "opacity: 0.25" %>
              <% end %>
            <% end %>

          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col s12">
      <div class="card hoverable z-depth-1">
        <div class="card-label">カテゴリー 構成比率</div>
        <div class="card-content">
          <%= pie_chart @component_rate, suffix: "個" %>
        </div>
      </div>
    </div>
  </div>


  <div class="row">
    <div class="col s12">
      <div class="card hoverable z-depth-1">
        <div class="card-label">カテゴリー コンプリート率</div>
        <div class="card-content">
          <%= bar_chart @complete_rate, min: 0, max: 100, suffix: "%" %>
        </div>
      </div>
    </div>
  </div>


</div>
