<div class="container">


  <div class="row">
    <div class="col s12">
      <div class="card hoverable z-depth-1">
        <div class="card-label">検索</div>
        <div class="card-content">
          <%= form_tag searchs_path, method: :get do %>
            <div class="input-field">
              <i class="material-icons prefix">search</i>
              <%= text_field_tag :q, nil %>
              <%= label_tag :検索ワード %>
            </div>
            <div>
              <label>
                <%= radio_button_tag :radio, :user %><span>キャラクター</span>
              </label>
            </div>
            <div>
              <label>
                <%= radio_button_tag :radio, :minion %><span>ミニオン</span>
              </label>
            </div>
            <div class="center">
            <%= button_tag '検索', class: 'btn waves-effect waves-light', type: 'button', onclick: 'submit();' %>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <% if params[:radio] == "user" %>

    <div class="row">
      <div class="col s12">
        <div class="card hoverable z-depth-1">
          <div class="card-label">検索結果</div>
          <div class="card-content">
            <div class="search-result">
              <%= @users.total_count %>件の検索結果が見つかりました 検索ワード: <%= params[:q] %>
            </div>
            <table class="centered">
              <thead>
                <tr>
                  <th></th>
                  <th>キャラクター名</th>
                  <th>サーバー名</th>
                  <th>ミニオン取得数</th>
                </tr>
              </thead>
              <tbody>
                <% @users.each do |user| %>
                  <tr>
                    <td><%= image_tag "#{user.image_url}", class: "character-image-sm" %></td>
                    <td><%= link_to user.name, user_path(user) %></td>
                    <td><%= user.server %></td>
                    <td><%= user.user_minions.count %></td>
                  </tr>
                <% end %>
              </tbody>
            </table>
            <div class="center">
              <%= paginate @minions %>
            </div>
          </div>
        </div>
      </div>
    </div>

  <% elsif params[:radio] == "minion" %>

    <div class="row">
      <div class="col s12">
        <div class="card hoverable z-depth-1">
          <div class="card-label">検索結果</div>
          <div class="card-content">
            <div class="search-result">
              <%= @minions.total_count %>件の検索結果が見つかりました 検索ワード: <%= params[:q] %>
            </div>
            <table class="centered">
              <thead>
                <tr>
                  <th></th>
                  <th>ミニオン名</th>
                  <th>カテゴリー</th>
                  <th>取得済み</th>
                  <th>ユーザー取得率</th>
                </tr>
              </thead>
              <tbody>
                <% @minions.each do |minion| %>
                  <tr>
                    <td><%= image_tag "#{minion.image_url}" %></td>
                    <td><%= minion.name %></td>
                    <td><%= minion.category.name %></td>
                    <td>
                      <% if minion.owned_by?(current_user) %>
                        <i class="material-icons">check</i>
                      <% end %>
                    </td>
                    <td><%= minion.rarity.round(1) %>%</td>
                  </tr>
                <% end %>
              </tbody>
            </table>
            <div class="center">
              <%= paginate @minions %>
            </div>
          </div>
        </div>
      </div>
    </div>

  <% end %>


</div>
